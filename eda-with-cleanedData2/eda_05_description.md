จากโค้ดในไฟล์ `goldprice_eda_05.ipynb` ผมได้จัดทำเอกสารอธิบายขั้นตอนการทำงาน เหตุผลในการเลือกเครื่องมือ และการวิเคราะห์ผลลัพธ์ในเชิง Data Science และ Economics ให้ดังนี้ครับ

---

# การวิเคราะห์ปัจจัยทางเศรษฐกิจที่มีผลต่อราคาทองคำ (Exploratory Data Analysis)

เอกสารนี้อธิบายกระบวนการวิเคราะห์ข้อมูล (Data Analysis Pipeline) เพื่อหาความสัมพันธ์ระหว่างราคาทองคำในประเทศไทยกับตัวแปรเศรษฐกิจมหภาคและสินทรัพย์ทางเลือก

## 1. การเตรียมข้อมูลและการทำความสะอาด (Data Loading & Preprocessing)

### 1.1 การโหลดและจัดการข้อมูลดิบ (`load_functions`)
**สิ่งที่โค้ดทำ:** สร้างฟังก์ชันแยกสำหรับโหลดไฟล์ CSV ของแต่ละสินทรัพย์ (Gold, Bitcoin, FX, SET Index, Oil, CPI)
**เทคนิคที่ใช้:**
* **Date Parsing:** แปลงคอลัมน์วันที่ให้เป็น datetime object เพื่อให้สามารถนำมา merge กันได้
* **String Manipulation:** แก้ไขข้อมูลที่มีลูกน้ำ (เช่น `1,600.50` ใน SET Index) ให้เป็นตัวเลขที่คำนวณได้
* **Filtering Logic:**
    * *Oil:* เลือกเฉพาะ **U.S. Diesel No.2** เพื่อใช้เป็นตัวแทนต้นทุนพลังงานโลก
    * *CPI:* เลือกเฉพาะรหัส 0 (รวมทุกรายการ) เพื่อดูภาพรวมเงินเฟ้อ

**เหตุผล (Why) & มุมมอง Data Sci:**
* **Modular Code:** การแยกฟังก์ชันช่วยให้ debug ง่าย หากไฟล์ต้นทางเปลี่ยน format ก็แก้แค่จุดเดียว
* **Domain Knowledge:** การเลือก U.S. Diesel หรือ CPI ตัวรวม แสดงถึงการเลือก **Benchmark** ที่เหมาะสมทางเศรษฐศาสตร์เพื่อเป็นตัวแทนของปัจจัยมหภาค

### 1.2 การรวมข้อมูล (Data Merging & Handling Missing Values)
**สิ่งที่โค้ดทำ:**
1.  ใช้ `functools.reduce` ร่วมกับ `pd.merge` เพื่อรวมทุกตารางด้วย `outer join` บนแกนวันที่
2.  ใช้ `ffill` (Forward Fill) เพื่อเติมค่าสูญหาย
3.  ตัดข้อมูลเฉพาะปี 2023 เป็นต้นไป (`dropna`)

**เหตุผล (Why) & มุมมอง Stat/Economics:**
* **Time Alignment:** ตลาดการเงินแต่ละสินทรัพย์มีวันหยุดไม่ตรงกัน (เช่น ตลาดหุ้นหยุดเสาร์-อาทิตย์ แต่ Crypto เทรด 24/7) การทำ Outer Join ทำให้วันไม่หาย
* **Imputation Strategy (ffill):** ในทางสถิติข้อมูล Time-series ทางการเงิน การใช้ **Last Traded Price** (ราคาล่าสุดที่ตกลงกันได้) เป็นตัวแทนของราคาในวันหยุด มีความสมเหตุสมผลมากกว่าการเติม 0 หรือค่าเฉลี่ย (Interpolation)
* **Stationarity Concern:** การตัดข้อมูลเฉพาะปี 2023 ช่วยลดปัญหา **Structural Break** (การเปลี่ยนโครงสร้างเศรษฐกิจ) จากช่วงโควิด ทำให้โมเดลจับ Trend ปัจจุบันได้แม่นยำกว่า

---

## 2. การวิเคราะห์ความสัมพันธ์ (Correlation Analysis)

### สิ่งที่โค้ดทำ (`Correlation Heatmap`)
**เครื่องมือ:** `seaborn.heatmap` พร้อม `cmap='RdBu'`
**สิ่งที่ได้จากการวิเคราะห์:**
* **Pearson Correlation Coefficient:** ค่าสหสัมพันธ์บอก "ทิศทาง" และ "ความแรง" ของความสัมพันธ์เชิงเส้น
* **Economic Interpretation:**
    * หาก **Gold vs FX** เป็นบวกสูง (สีน้ำเงินเข้ม): ยืนยันสมมติฐานว่าราคาทองไทยอิงกับค่าเงินบาทอ่อนค่า (บาทอ่อน -> ทองแพง)
    * หาก **Gold vs Oil/CPI** เป็นบวก: ทองคำทำหน้าที่เป็น **Inflation Hedge** (สินทรัพย์ป้องกันเงินเฟ้อ)

---

## 3. การเปรียบเทียบแนวโน้ม (Market Trends Visualization)

### สิ่งที่โค้ดทำ (`Normalized Plot`)
**เทคนิค:** **Min-Max Normalization**
$$X_{norm} = \frac{X - X_{min}}{X_{max} - X_{min}}$$
ปรับข้อมูลทุกตัวให้อยู่ในช่วง 0 ถึง 1 ก่อนพล็อตกราฟเส้นรวมกัน

**เหตุผล (Why):**
* **Scale Difference:** ราคาทอง (หลักหมื่น), Bitcoin (หลักล้าน), และ FX (หลักสิบ) มีหน่วยต่างกันมหาศาล หากพล็อตดิบๆ จะมองไม่เห็นความสัมพันธ์
* **Relative Performance:** การทำ Normalize ช่วยให้นักเศรษฐศาสตร์เปรียบเทียบ **Momentum** (แรงส่ง) ของราคาได้ว่าสินทรัพย์ไหนวิ่งแรงกว่ากันในช่วงเวลาเดียวกัน

---

## 4. การวิเคราะห์เชิงลึกรายคู่ (Scatter Plot with Regression)

### สิ่งที่โค้ดทำ (`sns.regplot`)
สร้างกราฟการกระจายตัว (Scatter) ระหว่าง Gold vs Bitcoin และ Gold vs FX พร้อมเส้นแนวโน้ม (Linear Regression Line)

**การตีความผลลัพธ์ (Interpretation):**

1.  **Gold vs Bitcoin (Digital Gold vs Physical Gold):**
    * *Stat:* หากจุดกระจายตัวกว้าง (High Variance) รอบเส้นกราฟ แสดงว่า Bitcoin มีความผันผวนสูงและไม่ได้แปรผันตรงกับทองคำเสมอไป (อาจเป็น Uncorrelated Asset ในบางช่วง)
    * *Econ:* ใช้ตรวจสอบว่า Bitcoin แย่งเม็ดเงินลงทุนจากทองคำหรือไม่ หรือนักลงทุนมองเป็นสินทรัพย์ประเภทเดียวกัน (Risk-on/Risk-off)

2.  **Gold vs FX (USD/THB):**
    * *Stat:* หากจุดเรียงตัวชิดเส้นตรง (Low Residuals) และมีความชันเป็นบวก แสดงว่าตัวแปรนี้มี **Predictive Power** (อำนาจการทำนาย) สูงมาก
    * *Econ:* นี่คือปัจจัยพื้นฐาน (Fundamental) ของราคาทองคำแท่งในไทย การเปลี่ยนแปลงของค่าเงินบาทส่งผลกระทบโดยตรง (Direct Pass-through) ต่อราคาทองคำ

---

### สรุป (Summary)
Notebook นี้ใช้หลักการ **Data Science** เพื่อจัดการข้อมูลที่ซับซ้อนให้พร้อมใช้ และใช้หลัก **Statistics** เพื่อหาความสัมพันธ์ที่ซ่อนอยู่ โดยมีเป้าหมายเพื่อตอบคำถามทาง **Economics** ว่า *"อะไรคือปัจจัยขับเคลื่อนราคาทองคำในประเทศไทยที่แท้จริงในช่วงปีที่ผ่านมา"*